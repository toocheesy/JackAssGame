<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JackAss Card Game</title>
    <link rel="stylesheet" href="/styles.css">
    <script src="/socket.io/socket.io.js" defer></script>
    <script src="/game.js" defer></script>
</head>
<body>
    <header class="header">
        <div class="logo">
            <span class="logo-text"><span class="j">J</span><span class="a">A</span></span>
        </div>
        <h1 class="title">JackAss</h1>
        <div class="nav-buttons">
            <button onclick="alert('Select 3 or 4 players, join the game, and avoid the Joker!')">How to Play</button>
            <button onclick="showStats()">Stats</button>
        </div>
    </header>

    <div class="game-container">
        <div class="game-info">
            <div>Round: 1</div>
            <div>Turn: <span id="current-turn">Player 1</span></div>
        </div>
        <div class="game-board" id="game-board"></div>
    </div>

    <footer class="footer">
        JackAss Card Game Â© 2025
    </footer>

    <div id="start-screen" class="start-screen">
        <div class="modal-content">
            <h1>JackAss Card Game</h1>
            <p>Be strategic! Don't get stuck with the Joker!</p>
            <div>
                <label for="player-name">Enter Your Name (or leave blank for Guest):</label>
                <input type="text" id="player-name" maxlength="20">
            </div>
            <div>
                <label for="num-players">Number of Players:</label>
                <select id="num-players">
                    <option value="3">3 Players</option>
                    <option value="4">4 Players</option>
                </select>
            </div>
            <button class="btn btn-play" onclick="joinGame()">Join Game</button>
            <p id="waiting-message">Waiting for players...</p>
        </div>
    </div>

    <div id="game-over-screen" class="game-over-screen hidden">
        <div class="modal-content">
            <h1 id="game-result">Game Over!</h1>
            <p id="winner-text"></p>
            <a href="javascript:window.location.reload()" class="btn">Play Again</a>
        </div>
    </div>

    <!-- Sound effects -->
    <audio id="win-jingle" src="/win-jingle.mp3" preload="auto"></audio>
    <audio id="losing-sound-effect" src="/losing-sound-effect.mp3" preload="auto"></audio>
    <audio id="match-made" src="/match-made.mp3" preload="auto"></audio>
    <audio id="player-turn" src="/player-turn.mp3" preload="auto"></audio>

    <script>
        const socket = io();
        let game;

        function joinGame() {
            const numPlayers = parseInt(document.getElementById('num-players').value);
            const playerName = document.getElementById('player-name').value;
            socket.emit('joinGame', { numPlayers, playerName }, (response) => {
                if (response.success) {
                    game = new JackAssGame('game-board', socket, response.tableId);
                    document.getElementById('start-screen').classList.add('hidden');
                } else {
                    alert('Failed to join game: ' + response.error);
                }
            });
        }

        function showStats() {
            const stats = JSON.parse(localStorage.getItem('jackassStats') || '{"wins":0,"losses":0,"games":0}');
            alert(`Games Played: ${stats.games}\nWins: ${stats.wins}\nLosses: ${stats.losses}\nWin Rate: ${stats.games ? ((stats.wins / stats.games) * 100).toFixed(2) : 0}%`);
        }
    </script>
</body>
</html>
